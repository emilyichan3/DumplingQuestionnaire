{% extends "base.html" %}

{% block additional_js %}
     <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
{% endblock %}

{% block main %}
<!-- dictionary -->
{% for answer in answers.values() %}
<div>
    <ul>
        <li id="question-{{ answer.questionnaire_id }}">Questionnaire: {{ answer.question }}</li>
        <li id="id-{{ answer.questionnaire_id }}">{{ answer.questionnaire_id }}</li>
        <li>Counts: {{ answer.count }}</li>
        <li id="keys-{{ answer.questionnaire_id }}">{{ answer.count.keys() | list }}</li>
        <li id="values-{{ answer.questionnaire_id }}">{{ answer.count.values() | list }}</li>
    </ul>
    <div class="chart-container">
        <canvas id="pieChart-{{ answer.questionnaire_id }}"></canvas>
    </div>
    <script>
        var ctx = document.getElementById("pieChart-{{ answer.questionnaire_id }}").getContext("2d");
        var pieChart = new Chart(ctx, {
                type: "pie",
                data: {
                    labels: {{ answer.count.keys() | list | safe }},
                    datasets: [{
                        textinfo: "label+percent",
                        backgroundColor: barColors,
                        data: {{ answer.count.values() | list | safe }}
                    }]
                },
                options: {
                    responsive: false,
                    plugins: {
                        title: {
                        display: true,
                        text: "{{ answer.question }}"
                        }
                    }
                }
            });        
    </script>

</div>
{% endfor %}
<div class="chart-container">
    <canvas id="pie-1"></canvas>
    <script src="/static/javascript/piechart.js"></script>
</div>
{% endblock %}